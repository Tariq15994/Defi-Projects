{"ast":null,"code":"import _asyncToGenerator from\"/home/tariq/Defi-Projects/nft-market-place/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/tariq/Defi-Projects/nft-market-place/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/home/tariq/Defi-Projects/nft-market-place/frontend/node_modules/@babel/runtime/regenerator/index.js\";import{useState,useEffect}from'react';import{ethers}from\"ethers\";import{Row,Col,Card}from'react-bootstrap';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function renderSoldItems(items){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Sold\"}),/*#__PURE__*/_jsx(Row,{xs:1,md:2,lg:4,className:\"g-4 py-3\",children:items.map(function(item,idx){return/*#__PURE__*/_jsx(Col,{className:\"overflow-hidden\",children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(Card.Img,{variant:\"top\",src:item.image}),/*#__PURE__*/_jsxs(Card.Footer,{children:[\"For \",ethers.utils.formatEther(item.totalPrice),\" ETH - Recieved \",ethers.utils.formatEther(item.price),\" ETH\"]})]})},idx);})})]});}export default function MyListedItems(_ref){var marketplace=_ref.marketplace,nft=_ref.nft,account=_ref.account;var _useState=useState(true),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),listedItems=_useState4[0],setListedItems=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),soldItems=_useState6[0],setSoldItems=_useState6[1];var loadListedItems=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var itemCount,listedItems,soldItems,indx,i,uri,response,metadata,totalPrice,item;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return marketplace.itemCount();case 2:itemCount=_context.sent;listedItems=[];soldItems=[];indx=1;case 6:if(!(indx<=itemCount)){_context.next=29;break;}_context.next=9;return marketplace.items(indx);case 9:i=_context.sent;if(!(i.seller.toLowerCase()===account)){_context.next=26;break;}_context.next=13;return nft.tokenURI(i.tokenId);case 13:uri=_context.sent;_context.next=16;return fetch(uri);case 16:response=_context.sent;_context.next=19;return response.json();case 19:metadata=_context.sent;_context.next=22;return marketplace.getTotalPrice(i.itemId);case 22:totalPrice=_context.sent;// define listed item object\nitem={totalPrice:totalPrice,price:i.price,itemId:i.itemId,name:metadata.name,description:metadata.description,image:metadata.image};listedItems.push(item);// Add listed item to sold items array if sold\nif(i.sold)soldItems.push(item);case 26:indx++;_context.next=6;break;case 29:setLoading(false);setListedItems(listedItems);setSoldItems(soldItems);case 32:case\"end\":return _context.stop();}}},_callee);}));return function loadListedItems(){return _ref2.apply(this,arguments);};}();useEffect(function(){loadListedItems();},[]);if(loading)return/*#__PURE__*/_jsxs(\"main\",{style:{minHeight:'100vh',color:'White',fontWeight:'bold',fontFamily:'Poppins, sans-serif'},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Loading...\"}),/*#__PURE__*/_jsx(\"div\",{className:\"container\"})]});return/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center\",style:{minHeight:'100vh'},children:listedItems.length>0?/*#__PURE__*/_jsxs(\"div\",{className:\"px-5 py-3 container\",children:[/*#__PURE__*/_jsx(\"h2\",{style:{padding:\"1rem 0\",color:'White',fontWeight:'bold',fontFamily:'Poppins, sans-serif'},children:\"Listed\"}),/*#__PURE__*/_jsx(Row,{xs:1,md:2,lg:4,className:\"g-4 py-3\",children:listedItems.map(function(item,idx){return/*#__PURE__*/_jsx(Col,{className:\"overflow-hidden\",children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(Card.Img,{variant:\"top\",src:item.image}),/*#__PURE__*/_jsxs(Card.Footer,{children:[ethers.utils.formatEther(item.totalPrice),\" ETH\"]})]})},idx);})}),soldItems.length>0&&renderSoldItems(soldItems)]}):/*#__PURE__*/_jsx(\"main\",{style:{padding:\"1rem 0\"},children:/*#__PURE__*/_jsx(\"h2\",{children:\"No listed assets\"})})});}","map":{"version":3,"sources":["/home/tariq/Defi-Projects/nft-market-place/frontend/src/components/MyListedItems.js"],"names":["useState","useEffect","ethers","Row","Col","Card","renderSoldItems","items","map","item","idx","image","utils","formatEther","totalPrice","price","MyListedItems","marketplace","nft","account","loading","setLoading","listedItems","setListedItems","soldItems","setSoldItems","loadListedItems","itemCount","indx","i","seller","toLowerCase","tokenURI","tokenId","uri","fetch","response","json","metadata","getTotalPrice","itemId","name","description","push","sold","minHeight","color","fontWeight","fontFamily","length","padding"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react'\nimport { ethers } from \"ethers\"\nimport { Row, Col, Card } from 'react-bootstrap'\n\nfunction renderSoldItems(items) {\n  return (\n    <>\n      <h2>Sold</h2>\n      <Row xs={1} md={2} lg={4} className=\"g-4 py-3\">\n        {items.map((item, idx) => (\n          <Col key={idx} className=\"overflow-hidden\">\n            <Card>\n              <Card.Img variant=\"top\" src={item.image} />\n              <Card.Footer>\n                For {ethers.utils.formatEther(item.totalPrice)} ETH - Recieved {ethers.utils.formatEther(item.price)} ETH\n              </Card.Footer>\n            </Card>\n          </Col>\n        ))}\n      </Row>\n    </>\n  )\n}\n\nexport default function MyListedItems({ marketplace, nft, account }) {\n  const [loading, setLoading] = useState(true)\n  const [listedItems, setListedItems] = useState([])\n  const [soldItems, setSoldItems] = useState([])\n  const loadListedItems = async () => {\n    // Load all sold items that the user listed\n    const itemCount = await marketplace.itemCount()\n    let listedItems = []\n    let soldItems = []\n    for (let indx = 1; indx <= itemCount; indx++) {\n      const i = await marketplace.items(indx)\n      if (i.seller.toLowerCase() === account) {\n        // get uri url from nft contract\n        const uri = await nft.tokenURI(i.tokenId)\n        // use uri to fetch the nft metadata stored on ipfs \n        const response = await fetch(uri)\n        const metadata = await response.json()\n        // get total price of item (item price + fee)\n        const totalPrice = await marketplace.getTotalPrice(i.itemId)\n        // define listed item object\n        let item = {\n          totalPrice,\n          price: i.price,\n          itemId: i.itemId,\n          name: metadata.name,\n          description: metadata.description,\n          image: metadata.image\n        }\n        listedItems.push(item)\n        // Add listed item to sold items array if sold\n        if (i.sold) soldItems.push(item)\n      }\n    }\n    setLoading(false)\n    setListedItems(listedItems)\n    setSoldItems(soldItems)\n  }\n  useEffect(() => {\n    loadListedItems()\n  }, [])\n  if (loading) return (\n    <main style={{   minHeight:'100vh',  color: 'White' ,fontWeight:'bold' ,fontFamily:'Poppins, sans-serif'}}>\n      <h2>Loading...</h2>\n      <div className='container'></div>\n    </main>\n  )\n  return (\n    <div className=\"flex justify-center\" style={{ minHeight:'100vh'}}>\n      {listedItems.length > 0 ?\n        <div className=\"px-5 py-3 container\">\n            <h2 style={ { padding: \"1rem 0\",  color: 'White' ,fontWeight:'bold' ,fontFamily:'Poppins, sans-serif'}}>Listed</h2>\n          <Row xs={1} md={2} lg={4} className=\"g-4 py-3\">\n            {listedItems.map((item, idx) => (\n              <Col key={idx} className=\"overflow-hidden\">\n                <Card>\n                  <Card.Img variant=\"top\" src={item.image} />\n                  <Card.Footer>{ethers.utils.formatEther(item.totalPrice)} ETH</Card.Footer>\n                </Card>\n              </Col>\n            ))}\n          </Row>\n            {soldItems.length > 0 && renderSoldItems(soldItems)}\n        </div>\n        : (\n          <main style={{ padding: \"1rem 0\" }}>\n            <h2>No listed assets</h2>\n          </main>\n        )}\n    </div>\n  );\n}"]},"metadata":{},"sourceType":"module"}